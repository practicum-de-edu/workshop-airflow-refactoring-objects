# workshop-airflow-refactoring-objects
Workshop to show how objects work for Airflow.

## Шаг 1. Отделяем вызов от реализации

Проблема: в DAG-файле смешаны вызовы функций и их реализация. Наша логика не может существовать отдельно от Airflow. Нет возможности тестировать логику без запуска DAG.

Решение: вынести реализацию в отдельный модуль.

Для этого:
1. Создаем папку `dwh` в корне проекта.
2. Создаем в ней папку dags - здесь будут DAG'и.
3. Создаем каталог `core` - здесь будет основная бизнес-логика.
4. Переносим логику в `core`. В `dags` остаются только вызовы функций.
5. Добавляем mount `dwh` в `docker-compose.yml`.
6. Добавляем тесты для `core`.


## Шаг 2. Выделяем конфигурацию
Проблема: конфигурация хранится внутри кода. Нет возможности переиспользовать конфигурацию в других DAG'ах. А если решим поменять конфигурацию, придется менять код (везде).

Решение: вынести конфигурацию в отдельный файл. 

Для этого:
1. Создаем файл `config.py` в каталогу `airflow/dags`.
2. Переносим чтение переменных, коннектов, настроек в `config.py`.
3. Импортируем конфигурацию в DAG-файл.


